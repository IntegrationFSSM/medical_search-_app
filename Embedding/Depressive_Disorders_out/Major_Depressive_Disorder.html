<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Évaluation Trouble Dépressif Majeur – DSM-5-TR</title>
  <style>
  .top-bar {
    display: flex;
    align-items: center;
    background-color: #dff0dc;
    padding: 10px 20px;
    margin-bottom: 30px;
    border-radius: 6px;
  }
  .titre-centre {
    flex: 1;
    text-align: center;
  }
  .titre-centre h1 {
    margin: 0;
    font-size: 28px;
    color: #3d7a3b;
  }
  .titre-centre h2 {
    margin: 0;
    font-size: 20px;
    color: #3d7a3b;
  }
  .section-title {
    font-size: 24px;
    font-weight: bold;
    color: #3d7a3b;
    margin: 30px 0 20px 0;
    padding-bottom: 10px;
    border-bottom: 3px solid #8cc63f;
  }

    body { font-family: 'Segoe UI', sans-serif; max-width: 960px; margin: auto; padding: 20px; background: #f5fff8; color: #2e3b2c; }
    fieldset { border: 2px solid #8cc63f; padding: 15px; margin-bottom: 20px; background: #ffffff; }
    legend { font-weight: bold; color: #3d7a3b; }
    label { display: block; margin-bottom: 5px; }
    button {
      background-color: #8cc63f;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      margin-top: 10px;
      cursor: pointer;
    }
    button:hover { background-color: #76b42f; }
    .hidden { display: none; }
    
    
    
    
    .boutons-validation {
      display: flex;
      gap: 15px;
      margin: 40px 0 20px 0;
      justify-content: center;
    }
    .btn-valide {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      flex: 1;
      max-width: 300px;
    }
    .btn-valide:hover {
      background-color: #218838;
    }
    .btn-non-valide {
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      flex: 1;
      max-width: 300px;
    }
    .btn-non-valide:hover {
      background-color: #c82333;
    }
    
    .subtitle {
      font-size: 0.9em;
      color: #666;
      font-style: italic;
    }
    .note-box {
      background: #e8f4fd;
      border-left: 4px solid #2196f3;
      padding: 10px;
      margin: 15px 0;
      font-style: italic;
    }
    
  </style>

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 
 
</head>
<body>

<div class="top-bar">
  <div class="titre-centre">
    <h1>CLINIQUE LA VALLÉE</h1>
    <h2>Évaluation du Trouble Dépressif Majeur – DSM-5-TR</h2>
  </div>
</div>

<h2 class="section-title">Les critères diagnostiques</h2>

<form id="formulaire">

<!-- Critère A -->
<fieldset id="critereA">
  <legend>Critère A – 5 symptômes ou plus (dont humeur dépressive OU perte d'intérêt)</legend>
  <p class="subtitle">Pendant la même période de 2 semaines, au moins un symptôme doit être (1) humeur dépressive OU (2) perte d'intérêt/plaisir</p>
  <p style="font-size: 0.9em; color: #666; font-style: italic; margin: 10px 0;">Note : Ne pas inclure les symptômes clairement attribuables à une affection médicale.
  </p>
  <label><input type="checkbox" name="critereA" value="1. Humeur dépressive presque toute la journée, presque tous les jours"/> 1. Humeur dépressive presque toute la journée, presque tous les jours (Note: chez enfants/adolescents, peut être humeur irritable)</label>
  <label><input type="checkbox" name="critereA" value="2. Diminution marquée de l'intérêt ou du plaisir"/> 2. Diminution marquée de l'intérêt ou du plaisir dans toutes ou presque toutes les activités</label>
  <label><input type="checkbox" name="critereA" value="3. Perte ou gain de poids significatif, ou changement d'appétit"/> 3. Perte ou gain de poids significatif (>5% en 1 mois), ou changement d'appétit</label>
  <label><input type="checkbox" name="critereA" value="4. Insomnie ou hypersomnie presque tous les jours"/> 4. Insomnie ou hypersomnie presque tous les jours</label>
  <label><input type="checkbox" name="critereA" value="5. Agitation ou ralentissement psychomoteur (observable)"/> 5. Agitation ou ralentissement psychomoteur presque tous les jours (observable par autrui)</label>
  <label><input type="checkbox" name="critereA" value="6. Fatigue ou perte d'énergie presque tous les jours"/> 6. Fatigue ou perte d'énergie presque tous les jours</label>
  <label><input type="checkbox" name="critereA" value="7. Sentiments de dévalorisation ou culpabilité excessive"/> 7. Sentiments de dévalorisation ou culpabilité excessive ou inappropriée (peut être délirante)</label>
  <label><input type="checkbox" name="critereA" value="8. Diminution de la capacité de penser, se concentrer ou indécision"/> 8. Diminution de la capacité de penser, se concentrer ou indécision presque tous les jours</label>
  <label><input type="checkbox" name="critereA" value="9. Pensées de mort récurrentes, idées suicidaires ou tentative"/> 9. Pensées de mort récurrentes, idées suicidaires (avec ou sans plan) ou tentative de suicide</label>
  
</fieldset>

<!-- Critère B -->
<fieldset id="critereB">
  <legend>Critère B – Détresse ou altération du fonctionnement</legend>
  <p class="subtitle">Les symptômes causent une détresse ou une altération cliniquement significative</p>
  <label><input type="checkbox" name="critereB" value="Détresse cliniquement significative"/> Détresse cliniquement significative</label>
  <label><input type="checkbox" name="critereB" value="Altération du fonctionnement social"/> Altération du fonctionnement social</label>
  <label><input type="checkbox" name="critereB" value="Altération du fonctionnement professionnel"/> Altération du fonctionnement professionnel</label>
  <label><input type="checkbox" name="critereB" value="Altération dans d'autres domaines importants"/> Altération dans d'autres domaines importants du fonctionnement</label>
  
</fieldset>

<!-- Critère C -->
<fieldset id="critereC">
  <legend>Critère C – Exclusion des causes organiques</legend>
  <p class="subtitle">L'épisode n'est pas attribuable aux effets physiologiques d'une substance ou d'une affection médicale</p>
  <p style="font-size: 0.9em; color: #666; font-style: italic; margin: 10px 0;">Note : Les réponses à une perte significative (deuil, ruine financière, catastrophe naturelle, maladie grave) peuvent inclure tristesse intense, rumination, insomnie, perte d'appétit et poids. Bien que ces symptômes puissent être compréhensibles, la présence d'un épisode dépressif majeur en plus de la réponse normale à la perte doit être soigneusement considérée selon l'histoire individuelle et les normes culturelles.
  </p>
  <label><input type="checkbox" name="critereC" value="Pas attribuable à une substance"/> Pas attribuable à une substance</label>
  <label><input type="checkbox" name="critereC" value="Pas attribuable à une affection médicale"/> Pas attribuable à une affection médicale</label>
  
</fieldset>

<!-- Critère D -->
<fieldset id="critereD">
  <legend>Critère D – Diagnostic différentiel</legend>
  <p class="subtitle">Au moins un épisode dépressif majeur n'est pas mieux expliqué par d'autres troubles psychotiques</p>
  <label><input type="checkbox" name="critereD" value="Pas mieux expliqué par trouble schizo-affectif"/> Pas mieux expliqué par trouble schizo-affectif</label>
  <label><input type="checkbox" name="critereD" value="Pas superposé à schizophrénie"/> Pas superposé à schizophrénie</label>
  <label><input type="checkbox" name="critereD" value="Pas superposé à trouble schizophréniforme"/> Pas superposé à trouble schizophréniforme</label>
  <label><input type="checkbox" name="critereD" value="Pas superposé à trouble délirant"/> Pas superposé à trouble délirant</label>
  <label><input type="checkbox" name="critereD" value="Pas superposé à autre trouble du spectre de la schizophrénie"/> Pas superposé à autre trouble du spectre de la schizophrénie ou autre trouble psychotique</label>
  
</fieldset>

<!-- Critère E -->
<fieldset id="critereE">
  <legend>Critère E – Jamais d'épisode maniaque ou hypomaniaque</legend>
  <p class="subtitle">Il n'y a jamais eu d'épisode maniaque ou hypomaniaque</p>
  <p style="font-size: 0.9em; color: #666; font-style: italic; margin: 10px 0;">Note : Cette exclusion ne s'applique PAS si tous les épisodes de type maniaque ou hypomaniaque sont induits par une substance ou attribuables aux effets physiologiques d'une affection médicale.
  </p>
  <label><input type="checkbox" id="choixE" value="Jamais d'épisode maniaque ou hypomaniaque"/> Jamais d'épisode maniaque ou hypomaniaque</label>
  
</fieldset>

<!-- Codage -->
<fieldset id="codage">
  <legend>Codage – Type d'épisode et Sévérité</legend>
  <p class="subtitle">Sélectionner le type d'épisode et la sévérité</p>
  
  <p style="margin-top: 10px;"><strong>Type d'épisode :</strong></p>
  <label><input type="radio" name="typeEpisode" value="Épisode unique"/> Épisode unique</label>
  <label><input type="radio" name="typeEpisode" value="Épisode récurrent"/> Épisode récurrent (intervalle d'au moins 2 mois consécutifs sans critères remplis)</label>
  
  <p style="margin-top: 15px;"><strong>Sévérité/État :</strong></p>
  <label><input type="radio" name="severite" value="Léger"/> Léger</label>
  <label><input type="radio" name="severite" value="Modéré"/> Modéré</label>
  <label><input type="radio" name="severite" value="Sévère"/> Sévère</label>
  <label><input type="radio" name="severite" value="Avec caractéristiques psychotiques"/> Avec caractéristiques psychotiques</label>
  <label><input type="radio" name="severite" value="En rémission partielle"/> En rémission partielle</label>
  <label><input type="radio" name="severite" value="En rémission complète"/> En rémission complète</label>
  <label><input type="radio" name="severite" value="Non spécifié"/> Non spécifié</label>
  
  
</fieldset>

<!-- Spécificateurs -->
<fieldset id="specificateurs">
  <legend>Spécificateurs additionnels (optionnels)</legend>
  <p class="subtitle">Cocher tous les spécificateurs qui s'appliquent à l'épisode actuel (ou le plus récent si en rémission)</p>
  <label><input type="checkbox" name="specificateurs" value="Avec détresse anxieuse"/> Avec détresse anxieuse</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractéristiques mixtes"/> Avec caractéristiques mixtes</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractéristiques mélancoliques"/> Avec caractéristiques mélancoliques</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractéristiques atypiques"/> Avec caractéristiques atypiques</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractéristiques psychotiques congruentes à l'humeur"/> Avec caractéristiques psychotiques congruentes à l'humeur</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractéristiques psychotiques non congruentes à l'humeur"/> Avec caractéristiques psychotiques non congruentes à l'humeur</label>
  <label><input type="checkbox" name="specificateurs" value="Avec catatonie (code additionnel F06.1)"/> Avec catatonie (code additionnel F06.1)</label>
  <label><input type="checkbox" name="specificateurs" value="Avec début lors du péripartum"/> Avec début lors du péripartum</label>
  <label><input type="checkbox" name="specificateurs" value="Avec caractère saisonnier (épisodes récurrents)"/> Avec caractère saisonnier (s'applique au pattern d'épisodes récurrents)</label>
  
</fieldset>


</form>

<h2 class="section-title" id="titre-diagnostic" style="display: none;">Diagnostic différentiel</h2>

<form id="formulaire-diff" style="display: none;">

<!-- Diagnostic différentiel -->
<fieldset id="diagnostic-differentiel">
  <legend>Diagnostic différentiel</legend>
  <p class="subtitle">Cocher les troubles à différencier</p>
  
  <label><input type="checkbox" name="diff_manic" value="Épisodes maniaques avec humeur irritable ou caractéristiques mixtes - Évaluation clinique nécessaire"/> Épisodes maniaques avec humeur irritable ou caractéristiques mixtes - Évaluation clinique nécessaire</label>
  
  <label><input type="checkbox" name="diff_bipolar" value="Troubles bipolaires I et II - Épisodes dépressifs majeurs avec antécédents d'épisodes maniaques/hypomaniaques"/> Troubles bipolaires I et II - Épisodes dépressifs majeurs avec antécédents d'épisodes maniaques/hypomaniaques</label>
  
  <label><input type="checkbox" name="diff_medical" value="Trouble dépressif dû à une affection médicale - Présence d'une affection médicale étiologique"/> Trouble dépressif dû à une affection médicale - Présence d'une affection médicale étiologique</label>
  
  <label><input type="checkbox" name="diff_substance" value="Trouble dépressif induit par substance/médicament - Substance étiologiquement liée à la perturbation de l'humeur"/> Trouble dépressif induit par substance/médicament - Substance étiologiquement liée à la perturbation de l'humeur</label>
  
  <label><input type="checkbox" name="diff_persistent" value="Trouble dépressif persistant - Humeur dépressive ≥2 ans"/> Trouble dépressif persistant - Humeur dépressive ≥2 ans</label>
  
  <label><input type="checkbox" name="diff_premenstrual" value="Trouble dysphorique prémenstruel - Dysphorie temporellement liée au cycle menstruel"/> Trouble dysphorique prémenstruel - Dysphorie temporellement liée au cycle menstruel</label>
  
  <label><input type="checkbox" name="diff_disruptive" value="Trouble de dysrégulation de l'humeur explosive - Irritabilité confinée aux épisodes dépressifs majeurs"/> Trouble de dysrégulation de l'humeur explosive - Irritabilité confinée aux épisodes dépressifs majeurs</label>
  
  <label><input type="checkbox" name="diff_schizoaffective" value="Trouble schizo-affectif - Délusions/hallucinations présentes ≥2 semaines en absence d'épisode dépressif majeur"/> Trouble schizo-affectif - Délusions/hallucinations présentes ≥2 semaines en absence d'épisode dépressif majeur</label>
  
  <label><input type="checkbox" name="diff_adhd" value="TDAH - Distractibilité et faible tolérance à la frustration peuvent survenir dans les deux"/> TDAH - Distractibilité et faible tolérance à la frustration peuvent survenir dans les deux</label>
  
  <label><input type="checkbox" name="diff_adjustment" value="Trouble de l'adaptation avec humeur dépressive - Les critères complets d'un épisode dépressif majeur ne sont pas remplis"/> Trouble de l'adaptation avec humeur dépressive - Les critères complets d'un épisode dépressif majeur ne sont pas remplis</label>
  
  <label><input type="checkbox" name="diff_bereavement" value="Deuil - Affect prédominant est sentiment de vide et perte"/> Deuil - Affect prédominant est sentiment de vide et perte</label>
  
  <label><input type="checkbox" name="diff_sadness" value="Tristesse normale - Périodes inhérentes à l'expérience humaine"/> Tristesse normale - Périodes inhérentes à l'expérience humaine</label>

</fieldset>

</form>

<h2 class="section-title" id="titre-comorbidite" style="display: none;">Comorbidité</h2>

<form id="formulaire-comorb" style="display: none;">

<!-- Comorbidité -->
<fieldset id="comorbidite">
  <legend>Comorbidité</legend>
  <p class="subtitle">Troubles associés</p>
  
  <label><input type="checkbox" name="comorb_substance" value="Troubles liés à l'utilisation de substances"/> Troubles liés à l'utilisation de substances</label>
  
  <label><input type="checkbox" name="comorb_panic" value="Trouble panique"/> Trouble panique</label>
  
  <label><input type="checkbox" name="comorb_gad" value="Trouble d'anxiété généralisée"/> Trouble d'anxiété généralisée</label>
  
  <label><input type="checkbox" name="comorb_ptsd" value="Trouble de stress post-traumatique"/> Trouble de stress post-traumatique</label>
  
  <label><input type="checkbox" name="comorb_ocd" value="Trouble obsessionnel-compulsif"/> Trouble obsessionnel-compulsif</label>
  
  <label><input type="checkbox" name="comorb_anorexia" value="Anorexie mentale"/> Anorexie mentale</label>
  
  <label><input type="checkbox" name="comorb_bulimia" value="Boulimie nerveuse"/> Boulimie nerveuse</label>
  
  <label><input type="checkbox" name="comorb_borderline" value="Trouble de la personnalité limite"/> Trouble de la personnalité limite</label>
  
  <p style="margin: 15px 0 10px 0; font-weight: bold;">Par genre :</p>
  <label><input type="checkbox" name="comorb_women" value="Femmes - Plus susceptibles d'avoir troubles anxieux comorbides, boulimie, trouble somatoforme"/> Femmes - Plus susceptibles d'avoir troubles anxieux comorbides, boulimie, trouble somatoforme</label>
  
  <label><input type="checkbox" name="comorb_men" value="Hommes - Plus susceptibles d'avoir abus d'alcool et de substances"/> Hommes - Plus susceptibles d'avoir abus d'alcool et de substances</label>

</fieldset>

</form>

<div class="boutons-validation">
  <button type="button" class="btn-valide" onclick="validerFormulaireLocal(event)">✔️ VALIDER</button>
  <button type="button" class="btn-non-valide" onclick="nonValiderFormulaireLocal(event)">✘ NON VALIDER</button>
</div>

<script>




else alert("Cochez au moins 5 symptômes (dont humeur dépressive OU perte d'intérêt)")}
else alert("Cochez au moins une option")}
else alert("Cochez au moins une option")}
else alert("Cochez au moins une option")}
else alert("Cochez la case")}
else alert("Sélectionnez type ET sévérité")}


  const code=codeTable[choix.typeEpisode][choix.severite];
  h+="<div class='code-section'><strong>Code:</strong> "+code+"<br/><strong>Diagnostic:</strong> "+code+" Trouble dépressif majeur, "+choix.typeEpisode.toLowerCase()+", "+choix.severite.toLowerCase();
  if(choix.specificateurs.length>0)h+=", "+choix.specificateurs.join(", ").toLowerCase();
  h+="</div></div>";
  h+="<div class='boutons-validation'><button class='btn-valide' onclick='validerFormulaire()'>✔️ VALIDE</button><button class='btn-non-valide' onclick='nonValiderFormulaire()'>✘ NON VALIDE</button></div></div>";
  document.getElementById("resultat").innerHTML=h;
}
</script>

<script>
(function() {
  if (typeof globalThis.validerFormulaire !== 'function') {
    globalThis.validerFormulaire = function() {
      Swal.fire({icon: 'success', title: 'Validé !', text: 'Formulaire marqué comme VALIDE', timer: 2000, showConfirmButton: false});
    };
  }
  if (typeof globalThis.nonValiderFormulaire !== 'function') {
    globalThis.nonValiderFormulaire = function() {
      Swal.fire({icon: 'warning', title: 'Non validé', text: 'Formulaire marqué comme NON VALIDE', timer: 2000, showConfirmButton: false});
    };
  }
})();
</script>

<footer style="text-align:center; font-size:0.9em; margin-top: 40px; padding-top: 15px; border-top: 1px solid #ccc;">
  <p>CLINIQUE LA VALLÉE – RIAD AL ANDALOUSSE VILLA 39, AV. ABDERRAHIM BOUABID, HAY RIAD 1, Rabat</p>
  <p>Date : 15/10/2025 — <strong style="color:darkred;">DOCUMENT CONFIDENTIEL</strong></p>
</footer>




<script>
);
}

);
}

// Fonctions locales pour gérer l'affichage progressif (indépendantes des fonctions globales Django)
(function() {
  'use strict';
  let etapeNonValide = 0; // 0: début, 1: diagnostic affiché, 2: comorbidité affichée

  // Fonction locale pour valider (ne pas redéfinir la fonction globale)
  window.validerFormulaireLocal = function(event) {
    // Empêcher le comportement par défaut et la propagation
    if (event) {
      event.preventDefault();
      event.stopPropagation();
      event.stopImmediatePropagation();
    }
    
    // Réinitialiser l'état local
    etapeNonValide = 0;
    
    // Cacher toutes les sections
    const titreDiag = document.getElementById("titre-diagnostic");
    const formDiag = document.getElementById("formulaire-diff");
    const titreComorb = document.getElementById("titre-comorbidite");
    const formComorb = document.getElementById("formulaire-comorb");
    
    if (titreDiag) titreDiag.style.display = "none";
    if (formDiag) formDiag.style.display = "none";
    if (titreComorb) titreComorb.style.display = "none";
    if (formComorb) formComorb.style.display = "none";
    
    // Appeler la fonction globale Django si elle existe
    if (typeof window.validerFormulaire === 'function') {
      window.validerFormulaire();
    }
    
    return false;
  };

  // Fonction locale pour non valider (ne pas redéfinir la fonction globale)
  window.nonValiderFormulaireLocal = function(event) {
    // Empêcher le comportement par défaut et la propagation IMMÉDIATEMENT
    if (event) {
      event.preventDefault();
      event.stopPropagation();
      event.stopImmediatePropagation();
    }
    
    const titreDiag = document.getElementById("titre-diagnostic");
    const formDiag = document.getElementById("formulaire-diff");
    const titreComorb = document.getElementById("titre-comorbidite");
    const formComorb = document.getElementById("formulaire-comorb");
    
    if (etapeNonValide === 0) {
      // Premier clic : Afficher seulement Diagnostic différentiel (PAS d'enregistrement, PAS d'alerte)
      if (titreDiag) {
        titreDiag.style.display = "block";
        titreDiag.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      if (formDiag) formDiag.style.display = "block";
      etapeNonValide = 1;
      return false;
      
    } else if (etapeNonValide === 1) {
      // Deuxième clic : Afficher aussi Comorbidité (PAS d'enregistrement, PAS d'alerte)
      if (titreComorb) {
        titreComorb.style.display = "block";
        titreComorb.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      if (formComorb) formComorb.style.display = "block";
      etapeNonValide = 2;
      return false;
      
    } else if (etapeNonValide === 2) {
      // Troisième clic : Réinitialiser et appeler la fonction globale Django
      etapeNonValide = 0;
      
      // Réinitialiser l'affichage
      if (titreDiag) titreDiag.style.display = "none";
      if (formDiag) formDiag.style.display = "none";
      if (titreComorb) titreComorb.style.display = "none";
      if (formComorb) formComorb.style.display = "none";
      
      // Appeler la fonction globale Django pour enregistrer
      if (typeof window.nonValiderFormulaire === 'function') {
        window.nonValiderFormulaire();
      }
      
      return false;
    }
    
    return false;
  };
})();

</script>

</body>
</html>
