<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Évaluation Trouble de Dysrégulation de l'Humeur Explosive – DSM-5-TR</title>
  <style>
  .top-bar {
    display: flex;
    align-items: center;
    background-color: #dff0dc;
    padding: 10px 20px;
    margin-bottom: 30px;
    border-radius: 6px;
  }
  .titre-centre {
    flex: 1;
    text-align: center;
  }
  .titre-centre h1 {
    margin: 0;
    font-size: 28px;
    color: #3d7a3b;
  }
  .titre-centre h2 {
    margin: 0;
    font-size: 20px;
    color: #3d7a3b;
  }
  .section-title {
    font-size: 24px;
    font-weight: bold;
    color: #3d7a3b;
    margin: 30px 0 20px 0;
    padding-bottom: 10px;
    border-bottom: 3px solid #8cc63f;
  }

    body { font-family: 'Segoe UI', sans-serif; max-width: 960px; margin: auto; padding: 20px; background: #f5fff8; color: #2e3b2c; }
    fieldset { border: 2px solid #8cc63f; padding: 15px; margin-bottom: 20px; background: #ffffff; }
    legend { font-weight: bold; color: #3d7a3b; }
    label { display: block; margin-bottom: 5px; }
    .subtitle {
      font-size: 0.9em;
      color: #666;
      font-style: italic;
    }
    .hidden {
      display: none;
    }
    .boutons-validation {
      display: flex;
      gap: 15px;
      margin: 40px 0 20px 0;
      justify-content: center;
    }
    .btn-valide {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      flex: 1;
      max-width: 300px;
    }
    .btn-valide:hover {
      background-color: #218838;
    }
    .btn-non-valide {
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 15px 40px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      flex: 1;
      max-width: 300px;
    }
    .btn-non-valide:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>

<div class="top-bar">
  <div class="titre-centre">
    <h1>CLINIQUE LA VALLÉE</h1>
    <h2>Évaluation du Trouble de Dysrégulation de l'Humeur Explosive – DSM-5-TR</h2>
  </div>
</div>

<h2 class="section-title">Les critères diagnostiques</h2>

<form id="formulaire">

<!-- Critère A -->
<fieldset id="critereA">
  <legend>Critère A – Accès de colère sévères et récurrents</legend>
  <p class="subtitle">Manifestés verbalement et/ou comportementalement, totalement disproportionnés en intensité ou durée par rapport à la situation</p>
  <label><input type="checkbox" name="critereA" value="Accès de colère sévères et récurrents"/> Accès de colère sévères et récurrents</label>
  <label><input type="checkbox" name="critereA" value="Manifestations verbales (rages verbales)"/> Manifestations verbales (rages verbales)</label>
  <label><input type="checkbox" name="critereA" value="Manifestations comportementales (agression physique envers personnes ou biens)"/> Manifestations comportementales (agression physique envers personnes ou biens)</label>
  <label><input type="checkbox" name="critereA" value="Totalement disproportionnés en intensité ou durée"/> Totalement disproportionnés en intensité ou durée par rapport à la situation ou provocation</label>
  
</fieldset>

<!-- Critère B -->
<fieldset id="critereB">
  <legend>Critère B – Incompatibles avec le niveau de développement</legend>
  <p class="subtitle">Les accès de colère sont incompatibles avec le niveau de développement de l'enfant</p>
  <label><input type="checkbox" id="choixB" value="Incompatibles avec le niveau de développement"/> Incompatibles avec le niveau de développement</label>
  
</fieldset>

<!-- Critère C -->
<fieldset id="critereC">
  <legend>Critère C – Fréquence (3 fois ou plus par semaine)</legend>
  <p class="subtitle">Les accès de colère surviennent en moyenne 3 fois ou plus par semaine</p>
  <label><input type="checkbox" id="choixC" value="Surviennent en moyenne 3 fois ou plus par semaine"/> Surviennent en moyenne 3 fois ou plus par semaine</label>
  
</fieldset>

<!-- Critère D -->
<fieldset id="critereD">
  <legend>Critère D – Humeur irritable ou colérique persistante entre les accès</legend>
  <p class="subtitle">L'humeur entre les accès est persistamment irritable ou colérique presque toute la journée, presque tous les jours, et observable par autrui</p>
  <label><input type="checkbox" name="critereD" value="Humeur persistamment irritable ou colérique"/> Humeur persistamment irritable ou colérique</label>
  <label><input type="checkbox" name="critereD" value="Presque toute la journée, presque tous les jours"/> Presque toute la journée, presque tous les jours</label>
  <label><input type="checkbox" name="critereD" value="Observable par autrui (parents, enseignants, pairs)"/> Observable par autrui (parents, enseignants, pairs)</label>
  
</fieldset>

<!-- Critère E -->
<fieldset id="critereE">
  <legend>Critère E – Durée (12 mois ou plus)</legend>
  <p class="subtitle">Les critères A-D sont présents depuis 12 mois ou plus, sans période de 3 mois consécutifs ou plus sans tous les symptômes</p>
  <label><input type="checkbox" name="critereE" value="Présents depuis 12 mois ou plus"/> Présents depuis 12 mois ou plus</label>
  <label><input type="checkbox" name="critereE" value="Pas de période de 3 mois consécutifs ou plus sans tous les symptômes"/> Pas de période de 3 mois consécutifs ou plus sans tous les symptômes</label>
  
</fieldset>

<!-- Critère F -->
<fieldset id="critereF">
  <legend>Critère F – Présence dans au moins 2 contextes sur 3</legend>
  <p class="subtitle">Les critères A et D sont présents dans au moins 2 contextes sur 3 (maison, école, pairs) et sévères dans au moins un</p>
  <label><input type="checkbox" name="critereF" value="Présents à la maison"/> Présents à la maison</label>
  <label><input type="checkbox" name="critereF" value="Présents à l'école"/> Présents à l'école</label>
  <label><input type="checkbox" name="critereF" value="Présents avec les pairs"/> Présents avec les pairs</label>
  <label><input type="checkbox" name="critereF" value="Sévères dans au moins un contexte"/> Sévères dans au moins un contexte</label>
  
</fieldset>

<!-- Critère G -->
<fieldset id="critereG">
  <legend>Critère G – Âge du diagnostic (entre 6 et 18 ans)</legend>
  <p class="subtitle">Le diagnostic ne doit pas être posé pour la première fois avant 6 ans ou après 18 ans</p>
  <label><input type="checkbox" name="critereG" value="Âge au moment du diagnostic entre 6 et 18 ans"/> Âge au moment du diagnostic entre 6 et 18 ans</label>
  
</fieldset>

<!-- Critère H -->
<fieldset id="critereH">
  <legend>Critère H – Âge de début (avant 10 ans)</legend>
  <p class="subtitle">Par anamnèse ou observation, l'âge de début des critères A-E est avant 10 ans</p>
  <label><input type="checkbox" id="choixH" value="Âge de début avant 10 ans"/> Âge de début avant 10 ans</label>
  
</fieldset>

<!-- Critère I -->
<fieldset id="critereI">
  <legend>Critère I – Jamais d'épisode maniaque ou hypomaniaque</legend>
  <p class="subtitle">Il n'y a jamais eu de période distincte durant plus d'1 jour où les critères complets (sauf durée) d'un épisode maniaque ou hypomaniaque ont été remplis</p>
  <p style="font-size: 0.9em; color: #666; font-style: italic; margin: 10px 0;">Note : L'élévation de l'humeur appropriée au développement (événement très positif) ne doit pas être considérée comme symptôme de manie ou d'hypomanie.
  </p>
  <label><input type="checkbox" id="choixI" value="Jamais d'épisode maniaque ou hypomaniaque"/> Jamais d'épisode maniaque ou hypomaniaque (>1 jour)</label>
  
</fieldset>

<!-- Critère J -->
<fieldset id="critereJ">
  <legend>Critère J – Diagnostic différentiel</legend>
  <p class="subtitle">Les comportements ne surviennent pas exclusivement pendant un épisode dépressif majeur et ne sont pas mieux expliqués par un autre trouble mental</p>
  <p style="font-size: 0.9em; color: #666; font-weight: bold; margin: 10px 0;">⚠️ Important : Ce diagnostic NE PEUT PAS coexister avec le trouble oppositionnel avec provocation, le trouble explosif intermittent ou le trouble bipolaire. Si les critères des deux troubles sont remplis, seul le DMDD est diagnostiqué. Si un épisode maniaque/hypomaniaque a déjà eu lieu, le DMDD ne doit PAS être assigné.</p>
  <label><input type="checkbox" name="critereJ" value="Ne survient pas exclusivement pendant un épisode dépressif majeur"/> Ne survient pas exclusivement pendant un épisode dépressif majeur</label>
  <label><input type="checkbox" name="critereJ" value="Pas mieux expliqué par trouble du spectre de l'autisme"/> Pas mieux expliqué par trouble du spectre de l'autisme</label>
  <label><input type="checkbox" name="critereJ" value="Pas mieux expliqué par trouble de stress post-traumatique"/> Pas mieux expliqué par trouble de stress post-traumatique</label>
  <label><input type="checkbox" name="critereJ" value="Pas mieux expliqué par trouble anxiété de séparation"/> Pas mieux expliqué par trouble anxiété de séparation</label>
  <label><input type="checkbox" name="critereJ" value="Pas mieux expliqué par trouble dépressif persistant"/> Pas mieux expliqué par trouble dépressif persistant</label>
  
</fieldset>

<!-- Critère K -->
<fieldset id="critereK">
  <legend>Critère K – Exclusion des causes organiques</legend>
  <p class="subtitle">Les symptômes ne sont pas attribuables aux effets physiologiques d'une substance ou d'une affection médicale/neurologique</p>
  <label><input type="checkbox" name="critereK" value="Pas attribuable à une substance"/> Pas attribuable à une substance</label>
  <label><input type="checkbox" name="critereK" value="Pas attribuable à une affection médicale ou neurologique"/> Pas attribuable à une affection médicale ou neurologique</label>
  
</fieldset>


</form>

<h2 class="section-title" id="titre-diagnostic" style="display: none;">Diagnostic différentiel</h2>

<form id="formulaire-diff" style="display: none;">

<!-- Diagnostic différentiel -->
<fieldset id="diagnostic-differentiel">
  <legend>Diagnostic différentiel</legend>
  <p class="subtitle">Cocher les troubles à différencier</p>
  
  <label><input type="checkbox" name="diff_bipolar" value="Troubles bipolaires - Distinction par évolution longitudinale (épisodique vs persistant)"/> Troubles bipolaires - Distinction par évolution longitudinale (épisodique vs persistant)</label>
  
  <label><input type="checkbox" name="diff_oppositional" value="Trouble oppositionnel avec provocation - Présence d'éclats sévères récurrents et perturbation persistante de l'humeur"/> Trouble oppositionnel avec provocation - Présence d'éclats sévères récurrents et perturbation persistante de l'humeur</label>
  
  <label><input type="checkbox" name="diff_adhd" value="TDAH, trouble dépressif majeur, troubles anxieux, trouble du spectre de l'autisme - Peuvent coexister"/> TDAH, trouble dépressif majeur, troubles anxieux, trouble du spectre de l'autisme - Peuvent coexister</label>
  
  <label><input type="checkbox" name="diff_explosive" value="Trouble explosif intermittent - Humeur irritabile persistante entre éclats non requise"/> Trouble explosif intermittent - Humeur irritable persistante entre éclats non requise</label>

</fieldset>

</form>

<h2 class="section-title" id="titre-comorbidite" style="display: none;">Comorbidité</h2>

<form id="formulaire-comorb" style="display: none;">

<!-- Comorbidité -->
<fieldset id="comorbidite">
  <legend>Comorbidité</legend>
  <p class="subtitle">Troubles associés</p>
  
  <label><input type="checkbox" name="comorb_high" value="Taux de comorbidité extrêmement élevés"/> Taux de comorbidité extrêmement élevés</label>
  
  <label><input type="checkbox" name="comorb_oppositional" value="Plus fort chevauchement avec trouble oppositionnel avec provocation"/> Plus fort chevauchement avec trouble oppositionnel avec provocation</label>
  
  <label><input type="checkbox" name="comorb_diverse" value="Gamme de maladies comorbides particulièrement diverse"/> Gamme de maladies comorbides particulièrement diverse</label>
  
  <label><input type="checkbox" name="comorb_presentations" value="Présentations avec large éventail de comportements perturbateurs, d'humeur, d'anxiété et même de symptômes du spectre autistique"/> Présentations avec large éventail de comportements perturbateurs, d'humeur, d'anxiété et même de symptômes du spectre autistique</label>

</fieldset>

</form>

<div class="boutons-validation">
  <button type="button" class="btn-valide" onclick="validerFormulaireLocal(event)">✔️ VALIDER</button>
  <button type="button" class="btn-non-valide" onclick="nonValiderFormulaireLocal(event)">✘ NON VALIDER</button>
</div>

<script>
// Fonctions locales pour gérer l'affichage progressif (indépendantes des fonctions globales Django)
(function() {
  'use strict';
  let etapeNonValide = 0; // 0: début, 1: diagnostic affiché, 2: comorbidité affichée

  // Fonction locale pour valider (ne pas redéfinir la fonction globale)
  window.validerFormulaireLocal = function(event) {
    // Empêcher le comportement par défaut et la propagation
    if (event) {
      event.preventDefault();
      event.stopPropagation();
      event.stopImmediatePropagation();
    }
    
    // Réinitialiser l'état local
    etapeNonValide = 0;
    
    // Cacher toutes les sections
    const titreDiag = document.getElementById("titre-diagnostic");
    const formDiag = document.getElementById("formulaire-diff");
    const titreComorb = document.getElementById("titre-comorbidite");
    const formComorb = document.getElementById("formulaire-comorb");
    
    if (titreDiag) titreDiag.style.display = "none";
    if (formDiag) formDiag.style.display = "none";
    if (titreComorb) titreComorb.style.display = "none";
    if (formComorb) formComorb.style.display = "none";
    
    // Appeler la fonction globale Django si elle existe
    if (typeof window.validerFormulaire === 'function') {
      window.validerFormulaire();
    }
    
    return false;
  };

  // Fonction locale pour non valider (ne pas redéfinir la fonction globale)
  window.nonValiderFormulaireLocal = function(event) {
    // Empêcher le comportement par défaut et la propagation IMMÉDIATEMENT
    if (event) {
      event.preventDefault();
      event.stopPropagation();
      event.stopImmediatePropagation();
    }
    
    const titreDiag = document.getElementById("titre-diagnostic");
    const formDiag = document.getElementById("formulaire-diff");
    const titreComorb = document.getElementById("titre-comorbidite");
    const formComorb = document.getElementById("formulaire-comorb");
    
    if (etapeNonValide === 0) {
      // Premier clic : Afficher seulement Diagnostic différentiel (PAS d'enregistrement, PAS d'alerte)
      if (titreDiag) {
        titreDiag.style.display = "block";
        titreDiag.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      if (formDiag) formDiag.style.display = "block";
      etapeNonValide = 1;
      return false;
      
    } else if (etapeNonValide === 1) {
      // Deuxième clic : Afficher aussi Comorbidité (PAS d'enregistrement, PAS d'alerte)
      if (titreComorb) {
        titreComorb.style.display = "block";
        titreComorb.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      if (formComorb) formComorb.style.display = "block";
      etapeNonValide = 2;
      return false;
      
    } else if (etapeNonValide === 2) {
      // Troisième clic : Réinitialiser et appeler la fonction globale Django
      etapeNonValide = 0;
      
      // Réinitialiser l'affichage
      if (titreDiag) titreDiag.style.display = "none";
      if (formDiag) formDiag.style.display = "none";
      if (titreComorb) titreComorb.style.display = "none";
      if (formComorb) formComorb.style.display = "none";
      
      // Appeler la fonction globale Django pour enregistrer
      if (typeof window.nonValiderFormulaire === 'function') {
        window.nonValiderFormulaire();
      }
      
      return false;
    }
    
    return false;
  };
})();
</script>

<footer style="text-align:center; font-size:0.9em; margin-top: 40px; padding-top: 15px; border-top: 1px solid #ccc;">
  <p>CLINIQUE LA VALLÉE – RIAD AL ANDALOUSSE VILLA 39, AV. ABDERRAHIM BOUABID, HAY RIAD 1, Rabat</p>
  <p>Date : 15/10/2025 — <strong style="color:darkred;">DOCUMENT CONFIDENTIEL</strong></p>
</footer>
</body>
</html>